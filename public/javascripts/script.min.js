var untangletech=untangletech||{};!function(n,a,t){"use strict";if(!a)return;t.home={},t.formvalidation={},t.main={},t.user={},t.wall={},a.fn.isInViewport=function(){var t=a(this).offset().top,s=t+a(this).outerHeight(),o=a(n).scrollTop(),e=o+a(n).height();return o<s&&t<e};t.init=function(){t.main.init(),t.formvalidation.init(),t.home.init(),a(".js-user-wall__blog-wrapper").length&&t.wall.init(),a(".js-user__blog-wrapper").length&&t.user.init()}}(window,jQuery,untangletech),function(t,o,s){untangletech.formvalidation.init=function(){o("form").each(function(){o(this).validate({ignore:".ignore",rules:{password:{minlength:5},confPassword:{minlength:5,equalTo:"#signupPassword"}},messages:{password:{minlength:"Please enter more than 5 characters"},confPassword:{minlength:"Please enter more than 5 characters",equalTo:"Please enter the same password as above"}}}),o(this).find('[type="submit"]').click(function(){var t=o(this).siblings("#recaptcha"),s=grecaptcha.getResponse();return 0!==t.length&&0===s.length?(o("#g-recaptcha-error").removeClass("hidden"),!1):(o(this).submit(),!0)})})}}(window,jQuery),function(t,s,o){o.init=function(){Cookies.get("showNL")||(s("#newsletterModal").modal("show"),s("#newsletterModal").on("hidden.bs.modal",function(){var t=Math.random().toString();t=t.substring(2,10),Cookies.set("showNL",t)}))}}(window,jQuery,untangletech.home),function(t,s,o){o.init=function(){console.log("Main function called"),s(".openbtn").on("click",function(){var t=s(this).data("sidebartype");s(this).data("main")?(s("#"+t+"Modal").modal("show"),s(this).siblings(".closebtn").trigger("click")):(s("#"+t+"Sidebar").css("width","25%"),s("#main > :not(.js-sidebar)").css("opacity","0.5"))}),s(".closebtn").on("click",function(){var t=s(this).data("sidebartype");s("#"+t+"Sidebar").css("width","0"),s("#main > :not(.js-sidebar)").css("opacity","1")}),s(".container").on("click",function(){s(".closebtn").trigger("click")}),s("#postSuccessModal").on("show.bs.modal",function(){var t=s(this);clearTimeout(t.data("hideInterval")),t.data("hideInterval",setTimeout(function(){t.modal("hide")},3e3))})},o.escapeHtml=function(t){var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/<script\b[^>]*>(.*?)<\/script>/g,"").replace(/[&<>"']/g,function(t){return s[t]})}}(window,jQuery,untangletech.main),function(a,i,t){var o={postButton:i(".js-user__post-button"),postText:i(".js-user__post"),postAddUrl:"/posts/add"},e=function(){i(".js-user__blog").on("click",function(){i("#fullBlogModal").modal("show"),i("#fullBlogModalText").html("<h1>"+i(this).data("heading")+"</h1><p>"+i(this).data("post")+"</p>")})},n=function(t){var s=t.html().match(/<[^> ]+[^>]*>[^<]*<\/[^> ]+[^>]*>/g),o="",e="";return s&&s.length&&(2<=s.length?(o=s[0].replace(/<\/?[^>]+(>|$)/g,""),e=s[1].replace(/<\/?[^>]+(>|$)/g,"")):s.length&&(e=s[1].replace(/<\/?[^>]+(>|$)/g,""))),{post:e,postHeading:o}},s=function(){if(i("footer").isInViewport()){var n=[],t=i.jStorage.get("posts");i.each(t,function(t,s){if(t<=5){var o=20<s.postHeading.length?s.postHeading.substr(0,19)+"...":s.postHeading,e=100<s.post.length?s.post.substr(0,99)+"...":s.post;i(".js-user__blog-wrapper > .row").append("<li class='col-lg-4 col-md-4 js-user__blog c-user__blog' data-heading='"+s.postHeading+"' data-post='"+s.post+"'><h2>"+o+"</h2><div>"+e+"</div></li>"),n.push(s)}}),t=t.filter(function(t){return i.inArray(t,n)<0}),i.jStorage.set("posts",t),e()}},l=function(){var t=n(o.postText),s={url:o.postAddUrl,type:"POST",data:{post:t.post,postHeading:t.postHeading},success:function(t){t.success?(i("#postSuccessModalText").html(t.infoMsg),i("#postSuccessModal").modal("show"),i(".js-user__post").empty()):a.location.href="/forms"}};o.postText.val(""),i(".js-user__post-button").prop("disabled",!0),i.ajax(s)};t.init=function(){var t;s(),i(".js-user__post-button").click(l),i(".js-user__post").click(function(){i("#postModal").modal("show");var t=n(i(this));i(".js-modal-user__post-heading").val(t.postHeading),i(".js-modal-user__post").val(t.post)}),i(".js-modal-user__post-button").click(function(){var t="<h1>"+untangletech.main.escapeHtml(i(this).siblings(".js-modal-user__post-heading").val())+"</h1>";t+="<div>"+untangletech.main.escapeHtml(i(this).siblings(".js-modal-user__post").val())+"</div>",i(".js-user__post").html(t),i("#postModal").modal("hide"),i(".js-user__post-button").prop("disabled",!t)}),t={url:"/posts",type:"POST",success:function(t){var n=[];i.each(t,function(t,s){if(i("body").height()<=i(a).height()){var o=20<s.postHeading.length?s.postHeading.substr(0,19)+"...":s.postHeading,e=100<s.post.length?s.post.substr(0,99)+"...":s.post;i(".js-user__blog-wrapper > .row").append("<li class='col-lg-4 col-md-4 js-user__blog c-user__blog' data-heading='"+s.postHeading+"' data-post='"+s.post+"'><h2>"+o+"</h2><div>"+e+"</div></li>"),n.push(s)}});var s=t.filter(function(t){return i.inArray(t,n)<0});i.jStorage.set("posts",s),e()}},i.ajax(t)}}(window,jQuery,untangletech.user),function(a,i,t){var o=function(){i(".js-user-wall__blog").on("click",function(){i("#fullBlogModal").modal("show"),i("#fullBlogModalText").html("<h1>"+i(this).data("heading")+"</h1><p>"+i(this).data("post")+"</p>")})},s=function(){if(i("footer").isInViewport()){var n=[],t=i.jStorage.get("wallPosts");i.each(t,function(t,s){if(t<=5){var o=20<s.postHeading.length?s.postHeading.substr(0,19)+"...":s.postHeading,e=100<s.post.length?s.post.substr(0,99)+"...":s.post;i(".js-user-wall__blog-wrapper > .row").append("<li class='col-lg-4 col-md-4 js-user-wall__blog c-user-wall__blog' data-heading='"+s.postHeading+"' data-post='"+s.post+"'><h2>"+o+"</h2><div>"+e+"</div></li>"),n.push(s)}}),t=t.filter(function(t){return i.inArray(t,n)<0}),i.jStorage.set("wallPosts",t),o()}};t.init=function(){console.log("Wall function"),function(){var t=i(".js-user-wall__blog-wrapper").data("userid");i.jStorage.set("userId",t);var s={url:"/users/"+t+"/posts",type:"POST",success:function(t){var n=[];i.each(t,function(t,s){if(i("body").height()<=i(a).height()){var o=20<s.postHeading.length?s.postHeading.substr(0,19)+"...":s.postHeading,e=100<s.post.length?s.post.substr(0,99)+"...":s.post;i(".js-user-wall__blog-wrapper > .row").append("<li class='col-lg-4 col-md-4 js-user-wall__blog c-user-wall__blog' data-heading='"+s.postHeading+"' data-post='"+s.post+"'><h2>"+o+"</h2><div>"+e+"</div></li>"),n.push(s)}});var s=t.filter(function(t){return i.inArray(t,n)<0});i.jStorage.set("wallPosts",s),o()}};i.ajax(s)}(),i(a).scroll(s)}}(window,jQuery,untangletech.wall);