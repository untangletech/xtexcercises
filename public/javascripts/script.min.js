$(function(){var e={postButton:$(".js-user__post-button"),postText:$(".js-user__post"),postAddUrl:"/posts/add"};if($("form").each(function(){$(this).validate({ignore:".ignore",rules:{password:{minlength:5},confPassword:{minlength:5,equalTo:"#signupPassword"}},messages:{password:{minlength:"Please enter more than 5 characters"},confPassword:{minlength:"Please enter more than 5 characters",equalTo:"Please enter the same password as above"}}}),$(this).find('[type="submit"]').click(function(){var e=$(this).siblings("#recaptcha"),s=grecaptcha.getResponse();return 0!==e.length&&0===s.length?($("#g-recaptcha-error").removeClass("hidden"),!1):($(this).submit(),!0)})}),e.postButton.prop("disabled",!0),e.postText.keyup(function(){e.postButton.prop("disabled",""==this.value)}),$("#user-story").length){var a=Handlebars.compile($("#user-story").html());e.postButton.click(function(){var s={url:e.postAddUrl,type:"POST",data:{post:e.postText.val().replace(/<script(.*)>(.*)<\/script>/,"")},success:function(e){e.success?($(".js-user__stories-wrapper").prepend(a({post:s.data.post.replace(new RegExp("\n","g"),"<br>"),isActive:!0})),$("#postSuccessModalText").html(e.infoMsg),$("#postSuccessModal").modal("show")):window.location.href="/"}};e.postText.val(""),e.postButton.prop("disabled",!0),$(".carousel-indicators li:first").trigger("click"),$.ajax(s)});var s={url:"/posts",type:"POST",success:function(t){$.each(t,function(e){var s=e===t.length-1?"class='active'":"";$(".c-user__stories-carousel .carousel-indicators").append("<li data-target='#c-user__stories-carousel' data-slide-to='"+e+"'"+s+"></li>"),$(".js-user__stories-wrapper").prepend(a({post:t[e].post.replace(new RegExp("\n","g"),"<br>"),active:e===t.length-1?"active":""}))})}};$.ajax(s)}$(".modal").on("show.bs.modal",function(){var e=$(this);clearTimeout(e.data("hideInterval")),e.data("hideInterval",setTimeout(function(){e.modal("hide")},3e3))})});